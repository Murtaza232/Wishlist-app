<button type="button" id="wishlist-add-btn" class="wishlist-add-btn" data-product-id="{{ product.id }}" data-customer-id="{{ customer.id }}" style="display: none;">
  <span id="wishlist-add-icon-container" style="display:inline-block;vertical-align:middle;"></span>
  <span id="wishlist-add-btn-text">Add To Wishlist</span>
</button>

<script>
  // Pass data to JavaScript file
  window.wishlistProductId = '{{ product.id }}';
  window.wishlistCustomerId = '{{ customer.id }}';
  
  // Immediately hide the button to prevent flash
  (function() {
    var btn = document.getElementById('wishlist-add-btn');
    if (btn) {
      btn.style.display = 'none';
      btn.style.visibility = 'hidden';
    }
  })();
</script>
<!-- Wishlist Modal (No faded background, always centered) -->
<style>
/* Immediate button hiding - highest priority */
#wishlist-add-btn, 
button#wishlist-add-btn, 
.wishlist-add-btn#wishlist-add-btn,
button.wishlist-add-btn#wishlist-add-btn {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  position: absolute !important;
  left: -9999px !important;
  top: -9999px !important;
}

@media (max-width: 600px) {
  .wishlist-add-btn {
    font-size: 13px;
    gap: 8px;
    width:200px;
    padding: 10px 0;
  }
}

@media (max-width: 1024px) {
  .wishlist-add-btn {
    font-size: 13px;
    gap: 8px;
    width:100px;
    padding: 10px 0;
  }
}

@media (max-width: 576px) {
  .wishlist-add-btn {
    font-size: 13px;
    gap: 8px;
    width:200px;
    padding: 10px 0;
  }
}
#wishlist-modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0; top: 0; width: 100vw; height: 100vh;
  background: transparent;
}
#wishlist-modal .wishlist-modal-content {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background: #fff;
  padding: 40px 32px 32px 32px;
  border-radius: 18px;
  width: 100%;
  max-width: 440px;
  min-width: 320px;
  min-height: 440px;
  max-height: 92vh;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0,0,0,0.18);
  display: flex;
  flex-direction: column;
  gap: 28px;
  font-family: inherit;
  font-size: 1.18rem; /* Base font size increased */
}
#wishlist-modal h3 {
  margin: 0 0 12px 0;
  font-size: 1.6rem;
  font-weight: 700;
  text-align: center;
  letter-spacing: 0.01em;
}
#wishlist-modal .wishlist-section-title {
  font-size: 1.18rem;
  font-weight: 600;
  margin: 0 0 10px 0;
  color: #444;
}
#wishlist-modal select,
#wishlist-modal input[type="text"] {
  width: 100%;
  direction: ltr;
  padding: 14px 14px;
  font-size: 1.18rem;
  border: 1.5px solid #ccc;
  border-radius: 7px;
  margin-bottom: 14px;
  box-sizing: border-box;
  background: #fafafa;
  transition: border 0.18s;
}
#wishlist-modal select:focus,
#wishlist-modal input[type="text"]:focus {
  border: 2px solid #111;
  outline: none;
}
#wishlist-modal button {
  width: 100%;
  padding: 15px 0;
  font-size: 1.18rem;
  border: none;
  border-radius: 7px;
  margin-bottom: 14px;
  background: #111;
  color: #fff;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.18s;
  letter-spacing: 0.01em;
}

/* Icon alignment for wishlist button */
#wishlist-add-icon-container {
  display: inline-block;
  vertical-align: middle;
  margin-bottom: 2px;
}

#wishlist-add-btn {
  display: none !important; /* Hidden by default, will be shown by JavaScript when appropriate */
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/* Additional rules to ensure button is hidden by default */
button#wishlist-add-btn.wishlist-add-btn {
  display: none !important;
}

.wishlist-add-btn#wishlist-add-btn {
  display: none !important;
}

/* Ensure icon and text are properly aligned */
#wishlist-add-icon-container svg,
#wishlist-add-icon-container img {
  vertical-align: middle;
  display: inline-block;
}
#wishlist-section-title{
  direction: ltr;
  font-size:1.18rem;
  font-weight:700;
}
#wishlist-modal button#wishlist-modal-close {
  background: #eee;
  color: #222;
  margin-top: 6px;
}
#wishlist-modal button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}
@media (max-width: 500px) {
  #wishlist-modal .wishlist-modal-content {
    min-width: 90vw;
    padding: 22px 6vw 22px 6vw;
    font-size: 1.05rem;
  }
}
</style>

<div id="wishlist-modal">
  <div class="wishlist-modal-content">
    <h3>Save to Wishlist</h3>
    <div id="wishlist-list-section">
      <div class="wishlist-section-title" dir="ltr" style="font-size:15px; font-weight:bold">Select Wishlist:</div>
      <select id="wishlist-select"></select>
      <button id="wishlist-add-to-selected-btn">Add to Selected</button>
    </div>
    <div id="wishlist-create-section">
      <div class="wishlist-section-title" dir="ltr" style="font-size:15px; font-weight:bold">Or create new:</div>
      <input type="text" id="wishlist-title-input" placeholder="Wishlist name" />
      <button id="wishlist-create-btn">Create and Add</button>
    </div>
    <button id="wishlist-modal-close">Cancel</button>
  </div>
</div>

<script>
  // Prevent duplicate execution
  if (window.wishlistScriptLoaded) {
  console.debug('[WISHLIST] Script already loaded, skipping duplicate execution');
  } else {
    window.wishlistScriptLoaded = true;
    var script = document.createElement('script');
    script.src = '{{ 'add-to-wishlist.js' | asset_url }}?v=' + Date.now();
    document.head.appendChild(script);
  }
</script>

{% schema %}
{
  "name": "Add to Wishlist",
  "target": "section", 
  "settings": []
}
{% endschema %}